{"version":3,"sources":["webpack://netlify-cms-backend-bitbucket/webpack/universalModuleDefinition","webpack://netlify-cms-backend-bitbucket/webpack/bootstrap","webpack://netlify-cms-backend-bitbucket/external \"netlify-cms-lib-util\"","webpack://netlify-cms-backend-bitbucket/external \"lodash/flow\"","webpack://netlify-cms-backend-bitbucket/external \"react\"","webpack://netlify-cms-backend-bitbucket/external \"prop-types\"","webpack://netlify-cms-backend-bitbucket/external \"netlify-cms-lib-auth\"","webpack://netlify-cms-backend-bitbucket//Users/erquhart/code/gh/netlify/netlify-cms/node_modules/semaphore/lib/semaphore.js","webpack://netlify-cms-backend-bitbucket/external \"netlify-cms-ui-default\"","webpack://netlify-cms-backend-bitbucket/external \"lodash/trimStart\"","webpack://netlify-cms-backend-bitbucket/external \"react-emotion\"","webpack://netlify-cms-backend-bitbucket/external \"lodash/get\"","webpack://netlify-cms-backend-bitbucket//Users/erquhart/code/gh/netlify/netlify-cms/node_modules/process/browser.js","webpack://netlify-cms-backend-bitbucket/./src/AuthenticationPage.js","webpack://netlify-cms-backend-bitbucket/./src/API.js","webpack://netlify-cms-backend-bitbucket/./src/implementation.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__4__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__8__","__WEBPACK_EXTERNAL_MODULE__9__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","process","global","nextTick","fn","setTimeout","capacity","semaphore","current","queue","firstHere","take","isFirst","item","arguments","task","length","leave","push","shift","Error","available","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","e","this","clearTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","noop","args","Array","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","LoginButtonIcon","external_react_emotion_default","external_netlify_cms_ui_default_","target","AuthenticationPage_BitbucketAuthenticationPage","external_react_default","a","Component","[object Object]","super","_defineProperty","preventDefault","cfg","base_url","props","site_id","document","location","host","split","siteId","auth_endpoint","authEndpoint","external_netlify_cms_lib_auth_","authenticate","provider","scope","err","data","setState","loginError","toString","onLogin","render","inProgress","createElement","handleLogin","loginDisabled","loginErrorMessage","state","renderButtonContent","Fragment","type","external_prop_types_default","func","isRequired","bool","string","API_API","constructor","config","API_defineProperty","req","flow_default","external_netlify_cms_lib_util_","withRoot","api_root","withTimestamp","buildRequest","requestFunction","catch","Promise","reject","message","withDefaultHeaders","Content-Type","request","format","repoURL","then","res","ok","file","_objectSpread","path","commit","hash","id","files","filter","isFile","map","processFile","async","sha","ref","branch","parseText","cacheKey","cachedFile","getItem","result","url","cache","setItem","jsonResponse","count","size","index","page","pageSize","pagelen","next","prev","previous","entries","values","pageCount","Math","ceil","undefined","cursor","actions","meta","links","_ref","withParams","sort","requestJSON","getEntriesAndCursor","processFiles","action","newCursor","getIn","_ref2","listFiles","initialCursor","currentCursor","has","_ref3","traverseCursor","newEntries","commitMessage","contentBlob","get_default","Blob","raw","formData","FormData","append","commitAuthor","_this$commitAuthor","email","withMethod","withBody","uploaded","all","uploadBlob","body","_this$commitAuthor2","repo","performRequest","hasWriteAccess","MAX_CONCURRENT_DOWNLOADS","implementation_Bitbucket","options","implementation_defineProperty","token","refreshedTokenPromise","withHeaders","Authorization","status","json","test","error","newToken","getRefreshedAccessToken","reqWithNewToken","sem","semaphore_default","promises","forEach","resolve","api","readFile","console","loadedEntries","loadedEntry","implementation_objectSpread","proxied","API","updateUserCredentials","useWorkflow","authComponent","setUser","user","apiRequestFunction","restoreUser","refreshToken","refresh_token","isCollab","assign","auth","authenticator","refresh","logout","getToken","entriesByFolder","collection","extension","listPromise","fetchFiles","allEntriesByFolder","listAllFiles","entriesByFiles","collectionFile","label","getEntry","slug","getMedia","getBlobPromise","finally","persistEntry","entry","mediaFiles","persistFiles","mediaFile","fileObj","trimStart_default","deleteFile"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,EAAAG,QAAA,wBAAAA,QAAA,eAAAA,QAAA,SAAAA,QAAA,cAAAA,QAAA,wBAAAA,QAAA,0BAAAA,QAAA,oBAAAA,QAAA,iBAAAA,QAAA,eACA,mBAAAC,eAAAC,IACAD,OAAA,4LAAAJ,GACA,iBAAAC,QACAA,QAAA,iCAAAD,EAAAG,QAAA,wBAAAA,QAAA,eAAAA,QAAA,SAAAA,QAAA,cAAAA,QAAA,wBAAAA,QAAA,0BAAAA,QAAA,oBAAAA,QAAA,iBAAAA,QAAA,eAEAJ,EAAA,iCAAAC,EAAAD,EAAA,wBAAAA,EAAA,eAAAA,EAAA,MAAAA,EAAA,cAAAA,EAAA,wBAAAA,EAAA,0BAAAA,EAAA,oBAAAA,EAAA,iBAAAA,EAAA,eARA,CASCO,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACD,mBCTA,IAAAC,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAjB,QAGA,IAAAC,EAAAc,EAAAE,IACAC,EAAAD,EACAE,GAAA,EACAnB,YAUA,OANAoB,EAAAH,GAAAI,KAAApB,EAAAD,QAAAC,IAAAD,QAAAgB,GAGAf,EAAAkB,GAAA,EAGAlB,EAAAD,QA0DA,OArDAgB,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAxB,EAAAyB,EAAAC,GACAV,EAAAW,EAAA3B,EAAAyB,IACAG,OAAAC,eAAA7B,EAAAyB,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAAhC,GACA,oBAAAiC,eAAAC,aACAN,OAAAC,eAAA7B,EAAAiC,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAA7B,EAAA,cAAiDmC,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAA1C,GACA,IAAAyB,EAAAzB,KAAAqC,WACA,WAA2B,OAAArC,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAe,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,GAIAhC,IAAAiC,EAAA,oBClFAhD,EAAAD,QAAAM,iBCAAL,EAAAD,QAAAO,iBCAAN,EAAAD,QAAAQ,iBCAAP,EAAAD,QAAAS,iBCAAR,EAAAD,QAAAU,oBCAA,SAAAwC,IAAC,SAAAC,GAED,aAEA,IAAAC,EAAA,SAAAC,GAA8BC,WAAAD,EAAA,SAC9B,IAAAH,MAAA,mBAAAA,EAAAE,WAEAA,EAAAF,EAAAE,UAmFAnD,EAAAD,QAhFA,SAAAuD,GACA,IAAAC,GACAD,YAAA,EACAE,QAAA,EACAC,SACAC,WAAA,EAEAC,KAAA,WACA,QAAAJ,EAAAG,UAAA,CACAH,EAAAC,UACAD,EAAAG,WAAA,EACA,IAAAE,EAAA,OAEAA,EAAA,EAEA,IAAAC,GAAenB,EAAA,GAEf,mBAAAoB,UAAA,GACAD,EAAAE,KAAAD,UAAA,GAEAD,EAAAnB,EAAAoB,UAAA,GAGAA,UAAAE,QAAA,IACA,mBAAAF,UAAA,GAAAD,EAAAE,KAAAD,UAAA,GACAD,EAAAnB,EAAAoB,UAAA,IAGA,IAAAC,EAAAF,EAAAE,KAGA,GAFAF,EAAAE,KAAA,WAA2BA,EAAAR,EAAAU,QAE3BV,EAAAC,QAAAK,EAAAnB,EAAAkB,EAAAL,EAAAD,SAKA,OAJA,IAAAM,IACAL,EAAAC,UACAD,EAAAG,WAAA,GAEAH,EAAAE,MAAAS,KAAAL,GAGAN,EAAAC,SAAAK,EAAAnB,EAAAkB,EACAC,EAAAE,KAAAR,EAAAU,OACA,IAAAL,IAAAL,EAAAG,WAAA,IAGAO,MAAA,SAAAvB,GAKA,GAJAA,KAAA,EAEAa,EAAAC,SAAAd,EAEAa,EAAAE,MAAAO,OAAA,CAQA,IAAAH,EAAAN,EAAAE,MAAA,GAEAI,EAAAnB,EAAAa,EAAAC,QAAAD,EAAAD,WAIAC,EAAAE,MAAAU,QACAZ,EAAAC,SAAAK,EAAAnB,EAEAS,EAAAU,EAAAE,YAhBA,GAAAR,EAAAC,QAAA,EACA,UAAAY,MAAA,iCAkBAC,UAAA,SAAA3B,GAEA,OADAA,KAAA,EACAa,EAAAC,QAAAd,GAAAa,EAAAD,WAIA,OAAAC,GArFC,qCCADvD,EAAAD,QAAAW,iBCAAV,EAAAD,QAAAY,iBCAAX,EAAAD,QAAAa,iBCAAZ,EAAAD,QAAAc,iBCCA,IAOAyD,EACAC,EARAtB,EAAAjD,EAAAD,WAUA,SAAAyE,IACA,UAAAJ,MAAA,mCAEA,SAAAK,IACA,UAAAL,MAAA,qCAsBA,SAAAM,EAAAC,GACA,GAAAL,IAAAjB,WAEA,OAAAA,WAAAsB,EAAA,GAGA,IAAAL,IAAAE,IAAAF,IAAAjB,WAEA,OADAiB,EAAAjB,WACAA,WAAAsB,EAAA,GAEA,IAEA,OAAAL,EAAAK,EAAA,GACK,MAAAC,GACL,IAEA,OAAAN,EAAAlD,KAAA,KAAAuD,EAAA,GACS,MAAAC,GAET,OAAAN,EAAAlD,KAAAyD,KAAAF,EAAA,MAvCA,WACA,IAEAL,EADA,mBAAAjB,WACAA,WAEAmB,EAEK,MAAAI,GACLN,EAAAE,EAEA,IAEAD,EADA,mBAAAO,aACAA,aAEAL,EAEK,MAAAG,GACLL,EAAAE,GAjBA,GAwEA,IAEAM,EAFAtB,KACAuB,GAAA,EAEAC,GAAA,EAEA,SAAAC,IACAF,GAAAD,IAGAC,GAAA,EACAD,EAAAf,OACAP,EAAAsB,EAAAI,OAAA1B,GAEAwB,GAAA,EAEAxB,EAAAO,QACAoB,KAIA,SAAAA,IACA,IAAAJ,EAAA,CAGA,IAAAK,EAAAX,EAAAQ,GACAF,GAAA,EAGA,IADA,IAAAM,EAAA7B,EAAAO,OACAsB,GAAA,CAGA,IAFAP,EAAAtB,EACAA,OACAwB,EAAAK,GACAP,GACAA,EAAAE,GAAAM,MAGAN,GAAA,EACAK,EAAA7B,EAAAO,OAEAe,EAAA,KACAC,GAAA,EAnEA,SAAAQ,GACA,GAAAjB,IAAAO,aAEA,OAAAA,aAAAU,GAGA,IAAAjB,IAAAE,IAAAF,IAAAO,aAEA,OADAP,EAAAO,aACAA,aAAAU,GAEA,IAEAjB,EAAAiB,GACK,MAAAZ,GACL,IAEA,OAAAL,EAAAnD,KAAA,KAAAoE,GACS,MAAAZ,GAGT,OAAAL,EAAAnD,KAAAyD,KAAAW,KAgDAC,CAAAJ,IAiBA,SAAAK,EAAAf,EAAAgB,GACAd,KAAAF,MACAE,KAAAc,QAYA,SAAAC,KA5BA3C,EAAAE,SAAA,SAAAwB,GACA,IAAAkB,EAAA,IAAAC,MAAAhC,UAAAE,OAAA,GACA,GAAAF,UAAAE,OAAA,EACA,QAAA/C,EAAA,EAAuBA,EAAA6C,UAAAE,OAAsB/C,IAC7C4E,EAAA5E,EAAA,GAAA6C,UAAA7C,GAGAwC,EAAAS,KAAA,IAAAwB,EAAAf,EAAAkB,IACA,IAAApC,EAAAO,QAAAgB,GACAN,EAAAU,IASAM,EAAA7C,UAAA0C,IAAA,WACAV,KAAAF,IAAAoB,MAAA,KAAAlB,KAAAc,QAEA1C,EAAA+C,MAAA,UACA/C,EAAAgD,SAAA,EACAhD,EAAAiD,OACAjD,EAAAkD,QACAlD,EAAAmD,QAAA,GACAnD,EAAAoD,YAIApD,EAAAqD,GAAAV,EACA3C,EAAAsD,YAAAX,EACA3C,EAAAuD,KAAAZ,EACA3C,EAAAwD,IAAAb,EACA3C,EAAAyD,eAAAd,EACA3C,EAAA0D,mBAAAf,EACA3C,EAAA2D,KAAAhB,EACA3C,EAAA4D,gBAAAjB,EACA3C,EAAA6D,oBAAAlB,EAEA3C,EAAA8D,UAAA,SAAAvF,GAAqC,UAErCyB,EAAA+D,QAAA,SAAAxF,GACA,UAAA4C,MAAA,qCAGAnB,EAAAgE,IAAA,WAA2B,WAC3BhE,EAAAiE,MAAA,SAAAC,GACA,UAAA/C,MAAA,mCAEAnB,EAAAmE,MAAA,WAA4B,gSCjL5B,MAAMC,EAAkBC,IAAOC,EAAA,MAAVC,OAAA,YAAGF,CAAH,4BAIAG,UAAoCC,EAAAC,EAAMC,UAAUC,eAAAhC,GAAAiC,SAAAjC,GAAAkC,EAAAlD,KAAA,YAAAkD,EAAAlD,KAAA,cAWzDD,IACZA,EAAEoD,iBACF,MAAMC,GACJC,SAAUrD,KAAKsD,MAAMD,SACrBE,QAC2C,cAAzCC,SAASC,SAASC,KAAKC,MAAM,KAAK,GAC9B,kBACA3D,KAAKsD,MAAMM,OACjBC,cAAe7D,KAAKsD,MAAMQ,cAEf,IAAIC,EAAA,qBAAqBX,GAEjCY,cAAeC,SAAU,YAAaC,MAAO,QAAU,CAACC,EAAKC,KAC5DD,EACFnE,KAAKqE,UAAWC,WAAYH,EAAII,aAGlCvE,KAAKsD,MAAMkB,QAAQJ,OAIvBK,SAAS,MACCC,EAAe1E,KAAKsD,MAApBoB,WAER,OACE7B,EAAAC,EAAA6B,cAACjC,EAAA,oBACC8B,QAASxE,KAAK4E,YACdC,cAAeH,EACfI,kBAAmB9E,KAAK+E,MAAMT,WAC9BU,oBAAqB,IACnBnC,EAAAC,EAAA6B,cAAC9B,EAAAC,EAAMmC,SAAP,KACEpC,EAAAC,EAAA6B,cAACnC,GAAgB0C,KAAK,cACrBR,EAAa,gBAAkB,6BA3CvB9B,eAEjB4B,QAASW,EAAArC,EAAUsC,KAAKC,WACxBX,WAAYS,EAAArC,EAAUwC,KACtBjC,SAAU8B,EAAArC,EAAUyC,OACpB3B,OAAQuB,EAAArC,EAAUyC,OAClBzB,aAAcqB,EAAArC,EAAUyC,+dCLPC,EACnBC,YAAYC,GAAQC,EAAA3F,KAAA,eAUL4F,GACbC,KAAMC,EAAA,cAAcC,SAAS/F,KAAKgG,UAAWF,EAAA,cAAcG,eAA3DJ,CAA2ED,IAXzDD,EAAA3F,KAAA,UAaV4F,GACRC,KACE7F,KAAKkG,aACLlG,KAAKmG,gBACLjI,GAAKA,EAAEkI,MAAMjC,GAAOkC,QAAQC,OAAO,IAAIR,EAAA,SAAS3B,EAAIoC,QAAS,KAAM,gBAHrEV,CAIGD,IAlBeD,EAAA3F,KAAA,cAoBN4F,GACZC,KACEC,EAAA,cAAcU,oBAAqBC,eAAgB,qBACnDzG,KAAK0G,QACL5J,OAAAgJ,EAAA,KAAAhJ,CAAKA,OAAAgJ,EAAA,eAAAhJ,EAAiB6J,OAAQ,UAC9BzI,GAAKA,EAAEkI,MAAMjC,GAAOkC,QAAQC,OAAO,IAAIR,EAAA,SAAS3B,EAAIoC,QAAS,KAAM,gBAJrEV,CAKGD,IA1BeD,EAAA3F,KAAA,cA2BN4F,GACZC,KACEC,EAAA,cAAcU,oBAAqBC,eAAgB,eACnDzG,KAAK0G,QACL5J,OAAAgJ,EAAA,KAAAhJ,CAAKA,OAAAgJ,EAAA,eAAAhJ,EAAiB6J,OAAQ,UAC9BzI,GAAKA,EAAEkI,MAAMjC,GAAOkC,QAAQC,OAAO,IAAIR,EAAA,SAAS3B,EAAIoC,QAAS,KAAM,gBAJrEV,CAKGD,IAjCeD,EAAA3F,KAAA,OAmCb,IAAMA,KAAK0G,QAAQ,UAnCNf,EAAA3F,KAAA,iBAoCH,IAAMA,KAAK0G,QAAQ1G,KAAK4G,SAASC,KAAKC,GAAOA,EAAIC,KApC9CpB,EAAA3F,KAAA,SAsCX,EAAGkF,UAAoB,gBAATA,GAtCHS,EAAA3F,KAAA,cAuCNgH,GAAIC,KACbD,GACHrK,KAAMG,OAAAgJ,EAAA,SAAAhJ,CAASkK,EAAKE,OAQhBF,EAAKG,QAAUH,EAAKG,OAAOC,MAASC,MAAOL,EAAKG,OAAOC,QAAQJ,EAAKE,aAjDtDvB,EAAA3F,KAAA,eAmDLsH,GAASA,EAAMC,OAAOvH,KAAKwH,QAAQC,IAAIzH,KAAK0H,cAnDvC/B,EAAA3F,KAAA,WAqDT2H,MAAOT,EAAMU,GAAOC,MAAM7H,KAAK8H,OAAQC,aAAY,SAC5D,MAAMC,EAAWD,QAAkBH,UAAcA,SAC3CK,EAAaL,QAAY9B,EAAA,YAAYoC,QAAQF,GAAY,KAC/D,GAAIC,EACF,OAAOA,EAET,MAAME,QAAenI,KAAK0G,SACxB0B,OAAQpI,KAAK4G,eAAeiB,KAAOX,IACnCmB,MAAO,aACNxB,KAAKkB,EAAYjL,OAAAgJ,EAAA,eAAAhJ,EAAiB6J,OAAQ,SAAY7J,OAAAgJ,EAAA,eAAAhJ,EAAiB6J,OAAQ,UAIlF,OAHIiB,GACF9B,EAAA,YAAYwC,QAAQN,EAAUG,GAEzBA,IAlEWxC,EAAA3F,KAAA,sBAqEEuI,IAAgB,MAE5BC,EAMJD,EANFE,KACMC,EAKJH,EALFI,KACSC,EAIPL,EAJFM,QACAC,EAGEP,EAHFO,KACUC,EAERR,EAFFS,SACQC,EACNV,EADFW,OAEIC,EAAYP,GAAYJ,EAAQY,KAAKC,KAAKb,EAAQI,QAAYU,EACpE,OACEL,UACAM,OAAQzD,EAAA,OAAOpI,QACb8L,YAAcV,GAAQ,cAAmBC,GAAQ,YACjDU,MAAQf,QAAOF,QAAOI,WAAUO,aAChC/E,MAAQsF,OAASZ,OAAMC,cApFTpD,EAAA3F,KAAA,YAyFR2H,UAAc,MAAAgC,QACU9D,KAEhCC,EAAA,cAAc8D,YAAaC,KAAM,UACjC7J,KAAK8J,YACLhN,OAAAgJ,EAAA,KAAAhJ,CAAKkD,KAAK+J,sBAJsBlE,IAK5B7F,KAAK4G,eAAe5G,KAAK8H,UAAUZ,KALjC+B,EADgBU,EAChBV,QAASM,EADOI,EACPJ,OAMjB,OAASN,QAASjJ,KAAKgK,aAAaf,GAAUM,YAhG5B5D,EAAA3F,KAAA,iBAmGH2H,MAAO4B,EAAQU,IAC9BpE,KACE7F,KAAK8J,YACLhN,OAAAgJ,EAAA,KAAAhJ,CAAKkD,KAAK+J,qBACVjN,OAAAgJ,EAAA,KAAAhJ,CAAK,EAAGyM,OAAQW,EAAWjB,eACzBM,OAAQW,EACRjB,QAASjJ,KAAKgK,aAAaf,OAL/BpD,CAOG0D,EAAOnF,KAAK+F,OAAO,QAASF,MA3GbtE,EAAA3F,KAAA,eA6GL2H,UAAc,MAAAyC,QACsCpK,KAAKqK,UAAUnD,GAAhEoD,EADWF,EACnBb,OACFN,MAFqBmB,EACInB,SAE/B,IAAIsB,EAAgBD,EACpB,KAAOC,GAAiBA,EAAcf,QAAQgB,IAAI,SAAS,OAAAC,QACAzK,KAAK0K,eAC5DH,EACA,QAFcL,EADyCO,EACjDlB,OAA4BoB,EADqBF,EAC9BxB,QAI3BA,EAAQ5J,QAAQsL,GAChBJ,EAAgBL,EAElB,OAAOlK,KAAKgK,aAAaf,KAzHPtD,EAAA3F,KAAA,aA4HP2H,MAAO3I,GAAQ4L,gBAAe9C,SAAS9H,KAAK8H,cACvD,MAAM+C,EAAcC,IAAI9L,EAAM,UAAW,IAAI+L,MAAM/L,EAAKgM,OAClDC,EAAW,IAAIC,SAOrB,GALAD,EAASE,OAAOnM,EAAKkI,KAAM2D,EAAa/N,OAAAgJ,EAAA,SAAAhJ,CAASkC,EAAKkI,OACtD+D,EAASE,OAAO,SAAUrD,GACtB8C,GACFK,EAASE,OAAO,UAAWP,GAEzB5K,KAAKoL,aAAc,OAAAC,EACGrL,KAAKoL,aAArBzO,EADa0O,EACb1O,KAAM2O,EADOD,EACPC,MACdL,EAASE,OAAO,YAAaxO,MAAS2O,MAGxC,OAAOzF,KACLC,EAAA,cAAcyF,WAAW,QACzBzF,EAAA,cAAc0F,SAASP,GACvBjL,KAAK0G,QACL5J,OAAAgJ,EAAA,KAAAhJ,CAAK,IAAAmK,KAAYjI,GAAMyM,UAAU,MAJ5B5F,IAKD7F,KAAK4G,iBA/IOjB,EAAA3F,KAAA,eAkJL,CAACsH,GAASsD,mBACvBvE,QAAQqF,IACNpE,EACGC,OAAO,EAAGkE,eAAgBA,GAC1BhE,IAAIT,GAAQhH,KAAK2L,WAAW3E,GAAQ4D,qBAtJvBjF,EAAA3F,KAAA,aAyJP,CAACkH,EAAMX,GAAWuB,SAAS9H,KAAK8H,cAC3C,MAAM8D,EAAO,IAAIV,SAMjB,GALAU,EAAKT,OAAO,QAASjE,GACrB0E,EAAKT,OAAO,SAAUrD,GAClBvB,GACFqF,EAAKT,OAAO,UAAW5E,GAErBvG,KAAKoL,aAAc,OAAAS,EACG7L,KAAKoL,aAArBzO,EADakP,EACblP,KAAM2O,EADOO,EACPP,MACdM,EAAKT,OAAO,YAAaxO,MAAS2O,MAEpC,OAAOzF,KAAMC,EAAA,cAAcyF,WAAW,QAASzF,EAAA,cAAc0F,SAASI,GAAO5L,KAAK0G,SAA3Eb,IACF7F,KAAK4G,iBApKV5G,KAAKgG,SAAWN,EAAOM,UAAY,gCACnChG,KAAK8H,OAASpC,EAAOoC,QAAU,SAC/B9H,KAAK8L,KAAOpG,EAAOoG,MAAQ,GAC3B9L,KAAKmG,gBAAkBT,EAAOS,iBAAmBL,EAAA,cAAciG,eAE/D/L,KAAKgM,eAAiBtG,EAAOsG,gBAAkBhM,KAAKgM,eACpDhM,KAAK4G,QAAU5G,KAAK8L,sBAAwB9L,KAAK8L,OAAS,4HCN9D,MAAMG,EAA2B,SAGZC,EACnBzG,YAAYC,EAAQyG,MASlB,GATgCC,EAAApM,KAAA,qBAyGb2H,UACnB,MAAM0E,EAAQrM,KAAKsM,4BAA8BtM,KAAKsM,sBAAwBtM,KAAKqM,MACnF,OAAOxG,KACLC,EAAA,cAAcyG,aAAcC,wBAAyBH,MACrDvG,EAAA,cAAciG,eACdjP,OAAAgJ,EAAA,KAAAhJ,CAAK6K,UACH,GAAmB,MAAfb,EAAI2F,OAAgB,CACtB,MAAMC,QAAa5F,EAAI4F,OAAOtG,MAAM,IAAM,MAC1C,GAAIsG,GAAsB,UAAdA,EAAKxH,MAAoB,yBAAyByH,KAAKD,EAAKE,MAAMrG,SAAU,CACtF,MAAMsG,QAAiB7M,KAAK8M,0BACtBC,EAAkBjH,EAAA,cAAcyG,aAClCC,wBAAyBK,KAC3BjH,GAEF,OAAOE,EAAA,cAAciG,eAAegB,IAGxC,OAAOjG,KAfJjB,CAiBJD,KA5H6BwG,EAAApM,KAAA,aA4JrBsH,IACX,MAAM0F,EAAMC,IAAUhB,GAChBiB,KAoBN,OAnBA5F,EAAM6F,QAAQnG,IACZkG,EAAS7N,KACP,IAAIgH,QAAQ+G,GACVJ,EAAIlO,KAAK,IACPkB,KAAKqN,IACFC,SAAStG,EAAKE,KAAMF,EAAKK,IACzBR,KAAKzC,IACJgJ,GAAUpG,OAAM5C,SAChB4I,EAAI5N,UAELgH,MAAM,CAACwG,GAAQ,KACdI,EAAI5N,QACJmO,QAAQX,6CAA6C5F,EAAKE,QAC1DkG,GAAUR,iBAMfvG,QAAQqF,IAAIwB,GAAUrG,KAAK2G,GAChCA,EAAcjG,OAAOkG,IAAgBA,EAAYb,UAlLnD5M,KAAK0F,OAASA,EACd1F,KAAKmM,0UAALuB,EACEC,SAAS,EACTC,IAAK,KACLC,sBAAuBlG,SAAY,MAChCwE,GAGDnM,KAAKmM,QAAQ2B,YACf,MAAM,IAAIvO,MAAM,kEAGlB,IAAKS,KAAKmM,QAAQwB,UAAYjI,EAAOyE,OAAO,UAAW,SAAS,GAC9D,MAAM,IAAI5K,MAAM,sEAGlBS,KAAKqN,IAAMrN,KAAKmM,QAAQyB,KAAO,KAE/B5N,KAAK6N,sBAAwB7N,KAAKmM,QAAQ0B,sBAE1C7N,KAAK8L,KAAOpG,EAAOyE,OAAO,UAAW,QAAS,IAC9CnK,KAAK8H,OAASpC,EAAOyE,OAAO,UAAW,UAAW,UAClDnK,KAAKgG,SAAWN,EAAOyE,OAAO,UAAW,YAAa,iCACtDnK,KAAKqD,SAAWqC,EAAOzI,IAAI,YAC3B+C,KAAKuD,QAAUmC,EAAOzI,IAAI,WAC1B+C,KAAKqM,MAAQ,GAGf0B,gBACE,OAAOnL,EAGToL,QAAQC,GACNjO,KAAKqM,MAAQ4B,EAAK5B,MAClBrM,KAAKqN,IAAM,IAAI7H,GACbW,gBAAiBnG,KAAKkO,mBACtBpG,OAAQ9H,KAAK8H,OACbgE,KAAM9L,KAAK8L,OAIfqC,YAAYF,GACV,OAAOjO,KAAKgE,aAAaiK,GAG3BjK,aAAae,GAUX,OATA/E,KAAKqM,MAAQtH,EAAMsH,MACnBrM,KAAKoO,aAAerJ,EAAMsJ,cAC1BrO,KAAKqN,IAAM,IAAI7H,GACbW,gBAAiBnG,KAAKkO,mBACtBpG,OAAQ9H,KAAK8H,OACbgE,KAAM9L,KAAK8L,KACX9F,SAAUhG,KAAKgG,WAGVhG,KAAKqN,IAAIY,OAAOpH,KAAKoH,GAC1BjO,KAAKqN,IAAIrB,eAAeiC,GAAMpH,KAAKyH,IACjC,IAAKA,EACH,MAAM,IAAI/O,MAAM,kEAClB,OAAOzC,OAAOyR,UAAWN,GAAQ5B,MAAOtH,EAAMsH,MAAOgC,cAAetJ,EAAMsJ,mBAKhFvB,0BACE,GAAI9M,KAAKsM,sBACP,OAAOtM,KAAKsM,sBAId,IAAKtM,KAAKwO,KAAM,CACd,MAAMpL,GACJC,SAAUrD,KAAKqD,SACfE,QAASvD,KAAKuD,SAEhBvD,KAAKyO,cAAgB,IAAI1K,EAAA,qBAAqBX,GAahD,OAVApD,KAAKsM,sBAAwBtM,KAAKyO,cAC/BC,SAAUzK,SAAU,YAAaoK,cAAerO,KAAKoO,eACrDvH,KAAK,EAAGwF,QAAOgC,oBACdrO,KAAKqM,MAAQA,EACbrM,KAAKoO,aAAeC,EACpBrO,KAAKsM,2BAAwBhD,EAC7BtJ,KAAK6N,uBAAwBxB,QAAOgC,kBAC7BhC,IAGJrM,KAAKsM,sBAGdqC,SACE3O,KAAKqM,MAAQ,KAIfuC,WACE,OAAI5O,KAAKsM,sBACAtM,KAAKsM,sBAGPjG,QAAQ+G,QAAQpN,KAAKqM,OAyB9BwC,gBAAgBC,EAAYC,GAC1B,MAAMC,EAAchP,KAAKqN,IAAIhD,UAAUyE,EAAW7R,IAAI,WACtD,OAAOH,OAAAgJ,EAAA,yBAAAhJ,EACLwK,MAAO0H,EACJnI,KAAK,EAAGoC,aAAcA,GACtBpC,KAAK/J,OAAAgJ,EAAA,sBAAAhJ,CAAsBiS,EAAW,SACtClI,KAAK7G,KAAKiP,YACb1F,OAAQyF,EAAYnI,KAAK,EAAG0C,YAAaA,KACxC1C,KAAK,EAAGS,QAAOiC,aAChBjC,EAAMxB,EAAA,6BAA+ByD,EAC9BjC,IAIX4H,mBAAmBJ,EAAYC,GAC7B,OAAO/O,KAAKqN,IACT8B,aAAaL,EAAW7R,IAAI,WAC5B4J,KAAK/J,OAAAgJ,EAAA,sBAAAhJ,CAAsBiS,EAAW,SACtClI,KAAK7G,KAAKiP,YAGfG,eAAeN,GACb,MAAMxH,EAAQwH,EAAW7R,IAAI,SAASwK,IAAI4H,KACxCnI,KAAMmI,EAAepS,IAAI,QACzBqS,MAAOD,EAAepS,IAAI,YAE5B,OAAO+C,KAAKiP,WAAW3H,GA8BzBiI,SAAST,EAAYU,EAAMtI,GACzB,OAAOlH,KAAKqN,IAAIC,SAASpG,GAAML,KAAKzC,KAClC4C,MAAQE,QACR9C,UAIJqL,WACE,MAAMzC,EAAMC,IAAUhB,GAEtB,OAAOjM,KAAKqN,IAAI8B,aAAanP,KAAK0F,OAAOzI,IAAI,iBAAiB4J,KAAKS,GACjEA,EAAMG,IAAI,EAAGJ,KAAI1K,OAAMuK,WAWrB,OAASG,KAAI1K,OAAM+S,eAVI,IACrB,IAAIrJ,QAAQ,CAAC+G,EAAS9G,IACpB0G,EAAIlO,KAAK,IACPkB,KAAKqN,IACFC,SAASpG,EAAMG,GAAMU,WAAW,IAChClB,KAAKuG,EAAS9G,GACdqJ,QAAQ,IAAM3C,EAAI5N,WAIQ8H,WAKzC0I,aAAaC,EAAOC,EAAY3D,MAC9B,OAAOnM,KAAKqN,IAAI0C,cAAcF,GAAQ1D,GAGxCnJ,mBAAmBgN,EAAW7D,YACtBnM,KAAKqN,IAAI0C,cAAcC,GAAY7D,GADC,MAElC9O,EAAyB2S,EAAzB3S,MAAO6J,EAAkB8I,EAAlB9I,KAAM+I,EAAYD,EAAZC,QAErB,OAAStT,KAAMU,EAAOoL,KAAMwH,EAAQxH,KAAMiH,eADnB,IAAMrJ,QAAQ+G,QAAQ6C,GACa/I,KAAMgJ,IAAUhJ,EAAM,OAGlFiJ,WAAWjJ,EAAM0D,EAAeuB,GAC9B,OAAOnM,KAAKqN,IAAI8C,WAAWjJ,EAAM0D,EAAeuB,GAGlDzB,eAAenB,EAAQU,GACrB,OAAOjK,KAAKqN,IAAI3C,eAAenB,EAAQU,GAAQpD,KAAKc,OAASsB,UAASM,OAAQW,OAC5EjB,cAAe5C,QAAQqF,IACrBzC,EAAQxB,IAAIT,GAAQhH,KAAKqN,IAAIC,SAAStG,EAAKE,KAAMF,EAAKK,IAAIR,KAAKzC,KAAW4C,OAAM5C,YAElFmF,OAAQW","file":"dist/netlify-cms-backend-bitbucket.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"netlify-cms-lib-util\"), require(\"lodash/flow\"), require(\"react\"), require(\"prop-types\"), require(\"netlify-cms-lib-auth\"), require(\"netlify-cms-ui-default\"), require(\"lodash/trimStart\"), require(\"react-emotion\"), require(\"lodash/get\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"netlify-cms-backend-bitbucket\", [\"netlify-cms-lib-util\", \"lodash/flow\", \"react\", \"prop-types\", \"netlify-cms-lib-auth\", \"netlify-cms-ui-default\", \"lodash/trimStart\", \"react-emotion\", \"lodash/get\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"netlify-cms-backend-bitbucket\"] = factory(require(\"netlify-cms-lib-util\"), require(\"lodash/flow\"), require(\"react\"), require(\"prop-types\"), require(\"netlify-cms-lib-auth\"), require(\"netlify-cms-ui-default\"), require(\"lodash/trimStart\"), require(\"react-emotion\"), require(\"lodash/get\"));\n\telse\n\t\troot[\"netlify-cms-backend-bitbucket\"] = factory(root[\"netlify-cms-lib-util\"], root[\"lodash/flow\"], root[\"react\"], root[\"prop-types\"], root[\"netlify-cms-lib-auth\"], root[\"netlify-cms-ui-default\"], root[\"lodash/trimStart\"], root[\"react-emotion\"], root[\"lodash/get\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__4__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__7__, __WEBPACK_EXTERNAL_MODULE__8__, __WEBPACK_EXTERNAL_MODULE__9__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;",";(function(global) {\n\n'use strict';\n\nvar nextTick = function (fn) { setTimeout(fn, 0); }\nif (typeof process != 'undefined' && process && typeof process.nextTick == 'function') {\n\t// node.js and the like\n\tnextTick = process.nextTick;\n}\n\nfunction semaphore(capacity) {\n\tvar semaphore = {\n\t\tcapacity: capacity || 1,\n\t\tcurrent: 0,\n\t\tqueue: [],\n\t\tfirstHere: false,\n\n\t\ttake: function() {\n\t\t\tif (semaphore.firstHere === false) {\n        \t\t\tsemaphore.current++;\n        \t\t\tsemaphore.firstHere = true;\n        \t\t\tvar isFirst = 1;\n      \t\t\t} else {\n        \t\t\tvar isFirst = 0;\n      \t\t\t}\n\t\t\tvar item = { n: 1 };\n\n\t\t\tif (typeof arguments[0] == 'function') {\n\t\t\t\titem.task = arguments[0];\n\t\t\t} else {\n\t\t\t\titem.n = arguments[0];\n\t\t\t}\n\n\t\t\tif (arguments.length >= 2)  {\n\t\t\t\tif (typeof arguments[1] == 'function') item.task = arguments[1];\n\t\t\t\telse item.n = arguments[1];\n\t\t\t}\n\n\t\t\tvar task = item.task;\n\t\t\titem.task = function() { task(semaphore.leave); };\n\n\t\t\tif (semaphore.current + item.n - isFirst > semaphore.capacity) {\n        \t\t\tif (isFirst === 1) {\n        \t\t\t\tsemaphore.current--;\n        \t\t\t\tsemaphore.firstHere = false;\n        \t\t\t}\n\t\t\t\treturn semaphore.queue.push(item);\n\t\t\t}\n\n\t\t\tsemaphore.current += item.n - isFirst;\n\t\t\titem.task(semaphore.leave);\n      \t\t\tif (isFirst === 1) semaphore.firstHere = false;\n\t\t},\n\n\t\tleave: function(n) {\n\t\t\tn = n || 1;\n\n\t\t\tsemaphore.current -= n;\n\n\t\t\tif (!semaphore.queue.length) {\n\t\t\t\tif (semaphore.current < 0) {\n\t\t\t\t\tthrow new Error('leave called too many times.');\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar item = semaphore.queue[0];\n\n\t\t\tif (item.n + semaphore.current > semaphore.capacity) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsemaphore.queue.shift();\n\t\t\tsemaphore.current += item.n;\n\n\t\t\tnextTick(item.task);\n\t\t},\n\n\t\tavailable: function(n) {\n\t\t\tn = n || 1;\n\t\t\treturn(semaphore.current + n <= semaphore.capacity);\n\t\t}\n\t};\n\n\treturn semaphore;\n};\n\nif (typeof exports === 'object') {\n    // node export\n    module.exports = semaphore;\n} else if (typeof define === 'function' && define.amd) {\n    // amd export\n    define(function () {\n        return semaphore;\n    });\n} else {\n    // browser global\n    global.semaphore = semaphore;\n}\n}(this));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'react-emotion';\nimport { NetlifyAuthenticator } from 'netlify-cms-lib-auth';\nimport { AuthenticationPage, Icon } from 'netlify-cms-ui-default';\n\nconst LoginButtonIcon = styled(Icon)`\n  margin-right: 18px;\n`;\n\nexport default class BitbucketAuthenticationPage extends React.Component {\n  static propTypes = {\n    onLogin: PropTypes.func.isRequired,\n    inProgress: PropTypes.bool,\n    base_url: PropTypes.string,\n    siteId: PropTypes.string,\n    authEndpoint: PropTypes.string,\n  };\n\n  state = {};\n\n  handleLogin = e => {\n    e.preventDefault();\n    const cfg = {\n      base_url: this.props.base_url,\n      site_id:\n        document.location.host.split(':')[0] === 'localhost'\n          ? 'cms.netlify.com'\n          : this.props.siteId,\n      auth_endpoint: this.props.authEndpoint,\n    };\n    const auth = new NetlifyAuthenticator(cfg);\n\n    auth.authenticate({ provider: 'bitbucket', scope: 'repo' }, (err, data) => {\n      if (err) {\n        this.setState({ loginError: err.toString() });\n        return;\n      }\n      this.props.onLogin(data);\n    });\n  };\n\n  render() {\n    const { inProgress } = this.props;\n\n    return (\n      <AuthenticationPage\n        onLogin={this.handleLogin}\n        loginDisabled={inProgress}\n        loginErrorMessage={this.state.loginError}\n        renderButtonContent={() => (\n          <React.Fragment>\n            <LoginButtonIcon type=\"bitbucket\" />\n            {inProgress ? 'Logging in...' : 'Login with Bitbucket'}\n          </React.Fragment>\n        )}\n      />\n    );\n  }\n}\n","import { flow, get } from 'lodash';\nimport {\n  localForage,\n  unsentRequest,\n  responseParser,\n  then,\n  basename,\n  Cursor,\n  APIError,\n} from 'netlify-cms-lib-util';\n\nexport default class API {\n  constructor(config) {\n    this.api_root = config.api_root || 'https://api.bitbucket.org/2.0';\n    this.branch = config.branch || 'master';\n    this.repo = config.repo || '';\n    this.requestFunction = config.requestFunction || unsentRequest.performRequest;\n    // Allow overriding this.hasWriteAccess\n    this.hasWriteAccess = config.hasWriteAccess || this.hasWriteAccess;\n    this.repoURL = this.repo ? `/repositories/${this.repo}` : '';\n  }\n\n  buildRequest = req =>\n    flow([unsentRequest.withRoot(this.api_root), unsentRequest.withTimestamp])(req);\n\n  request = req =>\n    flow([\n      this.buildRequest,\n      this.requestFunction,\n      p => p.catch(err => Promise.reject(new APIError(err.message, null, 'BitBucket'))),\n    ])(req);\n\n  requestJSON = req =>\n    flow([\n      unsentRequest.withDefaultHeaders({ 'Content-Type': 'application/json' }),\n      this.request,\n      then(responseParser({ format: 'json' })),\n      p => p.catch(err => Promise.reject(new APIError(err.message, null, 'BitBucket'))),\n    ])(req);\n  requestText = req =>\n    flow([\n      unsentRequest.withDefaultHeaders({ 'Content-Type': 'text/plain' }),\n      this.request,\n      then(responseParser({ format: 'text' })),\n      p => p.catch(err => Promise.reject(new APIError(err.message, null, 'BitBucket'))),\n    ])(req);\n\n  user = () => this.request('/user');\n  hasWriteAccess = () => this.request(this.repoURL).then(res => res.ok);\n\n  isFile = ({ type }) => type === 'commit_file';\n  processFile = file => ({\n    ...file,\n    name: basename(file.path),\n\n    // BitBucket does not return file SHAs, but it does give us the\n    // commit SHA. Since the commit SHA will change if any files do,\n    // we can construct an ID using the commit SHA and the file path\n    // that will help with caching (though not as well as a normal\n    // SHA, since it will change even if the individual file itself\n    // doesn't.)\n    ...(file.commit && file.commit.hash ? { id: `${file.commit.hash}/${file.path}` } : {}),\n  });\n  processFiles = files => files.filter(this.isFile).map(this.processFile);\n\n  readFile = async (path, sha, { ref = this.branch, parseText = true } = {}) => {\n    const cacheKey = parseText ? `bb.${sha}` : `bb.${sha}.blob`;\n    const cachedFile = sha ? await localForage.getItem(cacheKey) : null;\n    if (cachedFile) {\n      return cachedFile;\n    }\n    const result = await this.request({\n      url: `${this.repoURL}/src/${ref}/${path}`,\n      cache: 'no-store',\n    }).then(parseText ? responseParser({ format: 'text' }) : responseParser({ format: 'blob' }));\n    if (sha) {\n      localForage.setItem(cacheKey, result);\n    }\n    return result;\n  };\n\n  getEntriesAndCursor = jsonResponse => {\n    const {\n      size: count,\n      page: index,\n      pagelen: pageSize,\n      next,\n      previous: prev,\n      values: entries,\n    } = jsonResponse;\n    const pageCount = pageSize && count ? Math.ceil(count / pageSize) : undefined;\n    return {\n      entries,\n      cursor: Cursor.create({\n        actions: [...(next ? ['next'] : []), ...(prev ? ['prev'] : [])],\n        meta: { index, count, pageSize, pageCount },\n        data: { links: { next, prev } },\n      }),\n    };\n  };\n\n  listFiles = async path => {\n    const { entries, cursor } = await flow([\n      // sort files by filename ascending\n      unsentRequest.withParams({ sort: '-path' }),\n      this.requestJSON,\n      then(this.getEntriesAndCursor),\n    ])(`${this.repoURL}/src/${this.branch}/${path}`);\n    return { entries: this.processFiles(entries), cursor };\n  };\n\n  traverseCursor = async (cursor, action) =>\n    flow([\n      this.requestJSON,\n      then(this.getEntriesAndCursor),\n      then(({ cursor: newCursor, entries }) => ({\n        cursor: newCursor,\n        entries: this.processFiles(entries),\n      })),\n    ])(cursor.data.getIn(['links', action]));\n\n  listAllFiles = async path => {\n    const { cursor: initialCursor, entries: initialEntries } = await this.listFiles(path);\n    const entries = [...initialEntries];\n    let currentCursor = initialCursor;\n    while (currentCursor && currentCursor.actions.has('next')) {\n      const { cursor: newCursor, entries: newEntries } = await this.traverseCursor(\n        currentCursor,\n        'next',\n      );\n      entries.push(...newEntries);\n      currentCursor = newCursor;\n    }\n    return this.processFiles(entries);\n  };\n\n  uploadBlob = async (item, { commitMessage, branch = this.branch } = {}) => {\n    const contentBlob = get(item, 'fileObj', new Blob([item.raw]));\n    const formData = new FormData();\n    // Third param is filename header, in case path is `message`, `branch`, etc.\n    formData.append(item.path, contentBlob, basename(item.path));\n    formData.append('branch', branch);\n    if (commitMessage) {\n      formData.append('message', commitMessage);\n    }\n    if (this.commitAuthor) {\n      const { name, email } = this.commitAuthor;\n      formData.append('author', `${name} <${email}>`);\n    }\n\n    return flow([\n      unsentRequest.withMethod('POST'),\n      unsentRequest.withBody(formData),\n      this.request,\n      then(() => ({ ...item, uploaded: true })),\n    ])(`${this.repoURL}/src`);\n  };\n\n  persistFiles = (files, { commitMessage }) =>\n    Promise.all(\n      files\n        .filter(({ uploaded }) => !uploaded)\n        .map(file => this.uploadBlob(file, { commitMessage })),\n    );\n\n  deleteFile = (path, message, { branch = this.branch } = {}) => {\n    const body = new FormData();\n    body.append('files', path);\n    body.append('branch', branch);\n    if (message) {\n      body.append('message', message);\n    }\n    if (this.commitAuthor) {\n      const { name, email } = this.commitAuthor;\n      body.append('author', `${name} <${email}>`);\n    }\n    return flow([unsentRequest.withMethod('POST'), unsentRequest.withBody(body), this.request])(\n      `${this.repoURL}/src`,\n    );\n  };\n}\n","import semaphore from 'semaphore';\nimport { flow, trimStart } from 'lodash';\nimport {\n  CURSOR_COMPATIBILITY_SYMBOL,\n  filterByPropExtension,\n  resolvePromiseProperties,\n  then,\n  unsentRequest,\n} from 'netlify-cms-lib-util';\nimport { NetlifyAuthenticator } from 'netlify-cms-lib-auth';\nimport AuthenticationPage from './AuthenticationPage';\nimport API from './API';\n\nconst MAX_CONCURRENT_DOWNLOADS = 10;\n\n// Implementation wrapper class\nexport default class Bitbucket {\n  constructor(config, options = {}) {\n    this.config = config;\n    this.options = {\n      proxied: false,\n      API: null,\n      updateUserCredentials: async () => null,\n      ...options,\n    };\n\n    if (this.options.useWorkflow) {\n      throw new Error('The BitBucket backend does not support the Editorial Workflow.');\n    }\n\n    if (!this.options.proxied && !config.getIn(['backend', 'repo'], false)) {\n      throw new Error('The BitBucket backend needs a \"repo\" in the backend configuration.');\n    }\n\n    this.api = this.options.API || null;\n\n    this.updateUserCredentials = this.options.updateUserCredentials;\n\n    this.repo = config.getIn(['backend', 'repo'], '');\n    this.branch = config.getIn(['backend', 'branch'], 'master');\n    this.api_root = config.getIn(['backend', 'api_root'], 'https://api.bitbucket.org/2.0');\n    this.base_url = config.get('base_url');\n    this.site_id = config.get('site_id');\n    this.token = '';\n  }\n\n  authComponent() {\n    return AuthenticationPage;\n  }\n\n  setUser(user) {\n    this.token = user.token;\n    this.api = new API({\n      requestFunction: this.apiRequestFunction,\n      branch: this.branch,\n      repo: this.repo,\n    });\n  }\n\n  restoreUser(user) {\n    return this.authenticate(user);\n  }\n\n  authenticate(state) {\n    this.token = state.token;\n    this.refreshToken = state.refresh_token;\n    this.api = new API({\n      requestFunction: this.apiRequestFunction,\n      branch: this.branch,\n      repo: this.repo,\n      api_root: this.api_root,\n    });\n\n    return this.api.user().then(user =>\n      this.api.hasWriteAccess(user).then(isCollab => {\n        if (!isCollab)\n          throw new Error('Your BitBucker user account does not have access to this repo.');\n        return Object.assign({}, user, { token: state.token, refresh_token: state.refresh_token });\n      }),\n    );\n  }\n\n  getRefreshedAccessToken() {\n    if (this.refreshedTokenPromise) {\n      return this.refreshedTokenPromise;\n    }\n\n    // instantiating a new Authenticator on each refresh isn't ideal,\n    if (!this.auth) {\n      const cfg = {\n        base_url: this.base_url,\n        site_id: this.site_id,\n      };\n      this.authenticator = new NetlifyAuthenticator(cfg);\n    }\n\n    this.refreshedTokenPromise = this.authenticator\n      .refresh({ provider: 'bitbucket', refresh_token: this.refreshToken })\n      .then(({ token, refresh_token }) => {\n        this.token = token;\n        this.refreshToken = refresh_token;\n        this.refreshedTokenPromise = undefined;\n        this.updateUserCredentials({ token, refresh_token });\n        return token;\n      });\n\n    return this.refreshedTokenPromise;\n  }\n\n  logout() {\n    this.token = null;\n    return;\n  }\n\n  getToken() {\n    if (this.refreshedTokenPromise) {\n      return this.refreshedTokenPromise;\n    }\n\n    return Promise.resolve(this.token);\n  }\n\n  apiRequestFunction = async req => {\n    const token = this.refreshedTokenPromise ? await this.refreshedTokenPromise : this.token;\n    return flow([\n      unsentRequest.withHeaders({ Authorization: `Bearer ${token}` }),\n      unsentRequest.performRequest,\n      then(async res => {\n        if (res.status === 401) {\n          const json = await res.json().catch(() => null);\n          if (json && json.type === 'error' && /^access token expired/i.test(json.error.message)) {\n            const newToken = await this.getRefreshedAccessToken();\n            const reqWithNewToken = unsentRequest.withHeaders(\n              { Authorization: `Bearer ${newToken}` },\n              req,\n            );\n            return unsentRequest.performRequest(reqWithNewToken);\n          }\n        }\n        return res;\n      }),\n    ])(req);\n  };\n\n  entriesByFolder(collection, extension) {\n    const listPromise = this.api.listFiles(collection.get('folder'));\n    return resolvePromiseProperties({\n      files: listPromise\n        .then(({ entries }) => entries)\n        .then(filterByPropExtension(extension, 'path'))\n        .then(this.fetchFiles),\n      cursor: listPromise.then(({ cursor }) => cursor),\n    }).then(({ files, cursor }) => {\n      files[CURSOR_COMPATIBILITY_SYMBOL] = cursor;\n      return files;\n    });\n  }\n\n  allEntriesByFolder(collection, extension) {\n    return this.api\n      .listAllFiles(collection.get('folder'))\n      .then(filterByPropExtension(extension, 'path'))\n      .then(this.fetchFiles);\n  }\n\n  entriesByFiles(collection) {\n    const files = collection.get('files').map(collectionFile => ({\n      path: collectionFile.get('file'),\n      label: collectionFile.get('label'),\n    }));\n    return this.fetchFiles(files);\n  }\n\n  fetchFiles = files => {\n    const sem = semaphore(MAX_CONCURRENT_DOWNLOADS);\n    const promises = [];\n    files.forEach(file => {\n      promises.push(\n        new Promise(resolve =>\n          sem.take(() =>\n            this.api\n              .readFile(file.path, file.id)\n              .then(data => {\n                resolve({ file, data });\n                sem.leave();\n              })\n              .catch((error = true) => {\n                sem.leave();\n                console.error(`failed to load file from BitBucket: ${file.path}`);\n                resolve({ error });\n              }),\n          ),\n        ),\n      );\n    });\n    return Promise.all(promises).then(loadedEntries =>\n      loadedEntries.filter(loadedEntry => !loadedEntry.error),\n    );\n  };\n\n  getEntry(collection, slug, path) {\n    return this.api.readFile(path).then(data => ({\n      file: { path },\n      data,\n    }));\n  }\n\n  getMedia() {\n    const sem = semaphore(MAX_CONCURRENT_DOWNLOADS);\n\n    return this.api.listAllFiles(this.config.get('media_folder')).then(files =>\n      files.map(({ id, name, path }) => {\n        const getBlobPromise = () =>\n          new Promise((resolve, reject) =>\n            sem.take(() =>\n              this.api\n                .readFile(path, id, { parseText: false })\n                .then(resolve, reject)\n                .finally(() => sem.leave()),\n            ),\n          );\n\n        return { id, name, getBlobPromise, path };\n      }),\n    );\n  }\n\n  persistEntry(entry, mediaFiles, options = {}) {\n    return this.api.persistFiles([entry], options);\n  }\n\n  async persistMedia(mediaFile, options = {}) {\n    await this.api.persistFiles([mediaFile], options);\n    const { value, path, fileObj } = mediaFile;\n    const getBlobPromise = () => Promise.resolve(fileObj);\n    return { name: value, size: fileObj.size, getBlobPromise, path: trimStart(path, '/k') };\n  }\n\n  deleteFile(path, commitMessage, options) {\n    return this.api.deleteFile(path, commitMessage, options);\n  }\n\n  traverseCursor(cursor, action) {\n    return this.api.traverseCursor(cursor, action).then(async ({ entries, cursor: newCursor }) => ({\n      entries: await Promise.all(\n        entries.map(file => this.api.readFile(file.path, file.id).then(data => ({ file, data }))),\n      ),\n      cursor: newCursor,\n    }));\n  }\n}\n"],"sourceRoot":""}